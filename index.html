<!-- Force Vercel redeploy: adding comment for new deployment -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Format Preview</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet" />
    <!-- Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="styles.css" rel="stylesheet" />
</head>
<body>
    <div class="header">
        <h1>Content Format Preview</h1>
        <p>Create and preview your content in different formats</p>
    </div>
    
    <!-- Global error notification container -->
    <div id="globalErrorContainer" class="error-container">
        <div class="error-title">Error</div>
        <p class="error-message" id="globalErrorMessage"></p>
    </div>
    
    <div class="app-container">
        <div class="nav-sidebar">
            <button class="sidebar-toggle" id="sidebarToggle">
                <svg class="sidebar-toggle-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>
            <div class="nav-item active" data-view="tab-one">
                <span class="nav-item-icon">‚úèÔ∏è</span>
                <span class="nav-item-text">Content Editor</span>
            </div>
            <div class="nav-item" data-view="tab-two">
                <span class="nav-item-icon">ü§ñ</span>
                <span class="nav-item-text">AI Format</span>
            </div>
            <div class="nav-item" data-view="tab-three">
                <span class="nav-item-icon">‚öôÔ∏è</span> <!-- Example icon -->
                <span class="nav-item-text">AI Process</span>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Tab One View -->
            <div id="tab-one" class="view-container active">
                <div class="container">
                    <div class="text-box">
                        <h2>
                            <span>Content Editor</span>
                            <div class="heading-actions">
                                <button id="importButton" class="import-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Import File
                                </button>
                                <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls,.doc,.docx">
                            </div>
                        </h2>
                        
                        <!-- Wrap editor in its own pane -->
                        <div id="editor-pane">
                            <!-- Quill editor container with relative positioning -->
                            <div style="position: relative; flex-grow: 1; display: flex; flex-direction: column;">
                                <div id="editor-container"></div>
                                
                                <!-- Clear button positioned within editor area -->
                                <!-- Button removed as requested -->
                            </div>
                            <!-- Hidden textarea to store raw content -->
                            <textarea id="rawContent" class="raw-text"></textarea>
                            <!-- Import status moved inside output pane now -->
                        </div> 

                        <!-- Draggable Resize Handle -->
                        <div id="resize-handle"></div>

                        <!-- Wrap output section in its own pane -->
                        <div id="output-pane">
                            <!-- Format toggle -->
                            <div class="section-label">
                                Display Options
                                <button id="copyButton" class="copy-button" onclick="copyCurrentFormat()">Copy HTML to Clipboard</button>
                            </div>
                            <div class="toggle-container">
                                <button id="htmlToggle" class="toggle-button active" onclick="toggleFormat('html')">Show HTML</button>
                                <button id="markdownToggle" class="toggle-button" onclick="toggleFormat('markdown')">Show Markdown</button>
                            </div>
                            
                            <!-- Raw text output -->
                            <div class="output-container">
                                <textarea id="inputText" placeholder="Formatted code will appear here..."></textarea>
                            </div>
                            <!-- Moved import status here -->
                             <div id="importStatus" class="import-status"></div>
                        </div>
                    </div>
                    
                    <div class="text-box">
                        <h2>
                            <span>Card Preview</span>
                            <div class="heading-actions">
                                <!-- Screenshot Button for Tab 1 removed -->
                                <div class="style-selector">
                                    <select id="cardStyleSelector" class="style-dropdown">
                                        <option value="text-only">Text Only</option>
                                        <option value="with-intent" selected>With User Intent</option>
                                        <option value="with-pills">With Intent & Pills</option>
                                        <option value="with-quick-actions">With Quick Action Menu</option> <!-- Added -->
                                    </select>
                                </div>
                            </div>
                        </h2>
                        <div class="preview-container">
                            <!-- Card Preview -->
                            <div id="cardPreview" class="preview-content active preview-box">
                                <div class="card-preview-container">
                                    <div class="card-preview with-intent" id="cardPreviewContent">
                                        <div class="card-header">
                                            <span class="return-icon">‚Ü©</span>
                                            <span class="intent-label">User Intent</span>
                                        </div>
                                        <div class="card-content" id="cardContentArea1"></div>
                                        <div class="card-pill-container">
                                            <span class="card-pill">Option 1</span>
                                            <span class="card-pill">Option 2</span>
                                            <span class="card-pill">Option 3</span>
                                        </div>
                                        <!-- Separator and Quick Actions -->
                                        <hr class="card-separator">
                                        <div class="quick-action-menu">
                                            <span class="action-item" title="Copy">
                                                <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg>
                                            </span>
                                            <span class="action-item" title="Thumbs Up">
                                                <svg viewBox="0 0 24 24"><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"></path></svg>
                                            </span>
                                            <span class="action-item" title="Thumbs Down">
                                                 <svg viewBox="0 0 24 24"><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"></path></svg>
                                            </span>
                                            <span class="action-item" title="Share">
                                                 <svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"></path></svg>
                                            </span>
                                        </div>
                                        <!-- End Separator and Quick Actions -->
                                        <!-- Removed button from here -->
                                    </div>
                                </div>
                                <!-- Download button moved here (Tab 1) -->
                                <button id="screenshotButtonTab1" class="download-preview-button">Download Preview</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab Two View (modified layout) -->
            <div id="tab-two" class="view-container">
                <div class="container">
                    <div class="text-box">
                        <h2>
                            <span>Content Editor</span>
                            <div class="heading-actions">
                                <button id="importButton2" class="import-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Import File
                                </button>
                                <button id="aiFormatButton" class="import-button" style="background-color: #6200ea;">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <line x1="3" y1="9" x2="21" y2="9"></line>
                                        <path d="M9 21V9"></path>
                                        <path d="M15 9v3"></path>
                                        <path d="M15 15v6"></path>
                                        <circle cx="15" cy="12" r="0.5"></circle>
                                        <circle cx="15" cy="18" r="0.5"></circle>
                                    </svg>
                                    Format with AI
                                </button>
                                <button id="aiConfigButton" style="background: none; border: none; padding: 8px 5px; cursor: pointer; margin-left: 0;">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#6200ea" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
                                        <circle cx="12" cy="12" r="2"></circle>
                                        <path d="M12 6V4"></path>
                                        <path d="M12 20v-2"></path>
                                        <path d="M6 12H4"></path>
                                        <path d="M20 12h-2"></path>
                                        <path d="M16.24 7.76l-1.42 1.42"></path>
                                        <path d="M9.18 14.82l-1.42 1.42"></path>
                                        <path d="M16.24 16.24l-1.42-1.42"></path>
                                        <path d="M9.18 9.18l-1.42-1.42"></path>
                                    </svg>
                                </button>
                                <input type="file" id="fileInput2" class="file-input" accept=".xlsx,.xls,.doc,.docx">
                            </div>
                        </h2>
                        
                        <!-- Quill editor container with relative positioning -->
                        <div style="position: relative; flex-grow: 1; display: flex; flex-direction: column;">
                            <div id="editor-container2"></div>
                            <!-- Clear button for editor 2 never existed here -->
                        </div>
                        
                        <!-- Hidden textarea to store raw content -->
                        <textarea id="rawContent2" class="raw-text"></textarea>
                        
                        <!-- Import options - remove section but keep status -->
                        <div id="importStatus2" class="import-status"></div>
                        
                    </div> <!-- Moved this closing tag here to end the Content Editor text-box -->
                        
                    <!-- This Display Options text-box is now a sibling -->
                    <div class="text-box"> 
                        <h2>
                            <span>Display Options</span>
                            <button id="copyButton2" class="copy-button" onclick="copyCurrentFormat2()">Copy HTML to Clipboard</button>
                        </h2>
                        
                        <div class="toggle-container">
                            <button id="htmlToggle2" class="toggle-button active" onclick="toggleFormat2('html')">Show HTML</button>
                            <button id="markdownToggle2" class="toggle-button" onclick="toggleFormat2('markdown')">Show Markdown</button>
                        </div>
                        
                        <!-- Raw text output -->
                        <div class="output-container">
                            <textarea id="inputText2" placeholder="Formatted code will appear here..."></textarea>
                        </div>
                    </div> <!-- This was the original location of the closing tag -->
                </div>
            </div>
            
            <!-- Tab Three View (New - Cloned from Tab Two) -->
            <div id="tab-three" class="view-container"> <!-- ID changed -->
                <div class="container"> <!-- Using the same container class -->
                    <div class="text-box"> <!-- Using the same text-box class -->
                        <h2>
                            <span>AI Processing Step</span> <!-- Changed Title -->
                            <div class="heading-actions">
                                <button id="importButton3" class="import-button"> <!-- ID changed -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                    Import File
                                </button>
                                <button id="aiFormatButton3" class="import-button" style="background-color: #6200ea;"> <!-- ID changed -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <!-- Re-using AI icon, could change -->
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <line x1="3" y1="9" x2="21" y2="9"></line>
                                        <path d="M9 21V9"></path>
                                        <path d="M15 9v3"></path>
                                        <path d="M15 15v6"></path>
                                        <circle cx="15" cy="12" r="0.5"></circle>
                                        <circle cx="15" cy="18" r="0.5"></circle>
                                    </svg>
                                    Process with AI <!-- Changed Button Text -->
                                </button>
                                <!-- Config button can potentially be shared or specific -->
                                <button id="aiConfigButton3" style="background: none; border: none; padding: 8px 5px; cursor: pointer; margin-left: 0;"> <!-- ID changed (for now, maybe consolidate later) -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#6200ea" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
                                        <circle cx="12" cy="12" r="2"></circle>
                                        <path d="M12 6V4"></path>
                                        <path d="M12 20v-2"></path>
                                        <path d="M6 12H4"></path>
                                        <path d="M20 12h-2"></path>
                                        <path d="M16.24 7.76l-1.42 1.42"></path>
                                        <path d="M9.18 14.82l-1.42 1.42"></path>
                                        <path d="M16.24 16.24l-1.42-1.42"></path>
                                        <path d="M9.18 9.18l-1.42-1.42"></path>
                                    </svg>
                                </button>
                                <input type="file" id="fileInput3" class="file-input" accept=".xlsx,.xls,.doc,.docx"> <!-- ID changed -->
                            </div>
                        </h2>
                        
                        <!-- Quill editor container -->
                        <div style="position: relative; flex-grow: 1; display: flex; flex-direction: column;">
                            <div id="editor-container3"></div> <!-- ID changed -->
                            <!-- Clear button positioned within editor area (removed) -->
                        </div>
                        
                        <!-- Hidden textarea to store raw content -->
                        <textarea id="rawContent3" class="raw-text"></textarea> <!-- ID changed -->
                        
                        <!-- Import status -->
                        <div id="importStatus3" class="import-status"></div> <!-- ID changed -->
                        
                    </div> 
                        
                    <!-- Display Options box -->
                    <div class="text-box"> 
                        <h2>
                            <span>Display Options</span>
                            <button id="copyButton3" class="copy-button" onclick="copyCurrentFormat3()">Copy HTML to Clipboard</button> <!-- ID and onclick changed -->
                        </h2>
                        
                        <div class="toggle-container">
                            <button id="htmlToggle3" class="toggle-button active" onclick="toggleFormat3('html')">Show HTML</button> <!-- ID and onclick changed -->
                            <button id="markdownToggle3" class="toggle-button" onclick="toggleFormat3('markdown')">Show Markdown</button> <!-- ID and onclick changed -->
                        </div>
                        
                        <!-- Raw text output -->
                        <div class="output-container">
                            <textarea id="inputText3" placeholder="Processed code will appear here..."></textarea> <!-- ID and placeholder changed -->
                        </div>
                    </div> 
                </div>
            </div>
        </div>
    </div>

    <div id="copySuccess" class="copy-success"></div> <!-- Message set by JS -->

    <!-- Floating Preview Button (Initially Hidden) -->
    <button id="showPreviewButton" title="Show Card Preview">
        <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z"></path></svg>
    </button>
    
    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Select Import Format</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-options">
                <div class="modal-option" data-import-mode="word">
                    <div class="modal-option-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#2b579a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                    </div>
                    <div class="modal-option-text">
                        <div class="modal-option-title">Word Document</div>
                        <div class="modal-option-desc">Import formatted text from Word (.docx, .doc)</div>
                    </div>
                </div>
                <div class="modal-option" data-import-mode="excel-table">
                    <div class="modal-option-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#217346" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="3" y1="9" x2="21" y2="9"></line>
                            <line x1="3" y1="15" x2="21" y2="15"></line>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <line x1="15" y1="3" x2="15" y2="21"></line>
                        </svg>
                    </div>
                    <div class="modal-option-text">
                        <div class="modal-option-title">Excel (Table)</div>
                        <div class="modal-option-desc">Import entire worksheet as HTML table</div>
                    </div>
                </div>
                <div class="modal-option" data-import-mode="excel-cell">
                    <div class="modal-option-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#217346" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <rect x="9" y="9" width="6" height="6"></rect>
                        </svg>
                    </div>
                    <div class="modal-option-text">
                        <div class="modal-option-title">Excel (Single Cell)</div>
                        <div class="modal-option-desc">Import content from a single cell (A1)</div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-button modal-button-cancel" id="modalCancel">Cancel</button>
                <button class="modal-button modal-button-proceed" id="modalProceed">Proceed</button>
            </div>
        </div>
    </div>

    <!-- AI Config Modal -->
    <div id="aiConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">AI Configuration</h3>
                <!-- New View Selector Buttons -->
                <div class="modal-view-selector" style="margin-left: 20px;">
                    <button class="modal-view-tab active" data-view="system-settings-view">System Settings</button>
                    <button class="modal-view-tab" data-view="model-settings-view">Model Settings</button>
                </div>
                <button class="modal-close" id="aiModalClose" style="margin-left: auto;">&times;</button>
            </div>

            <!-- System Settings View -->
            <div id="system-settings-view" class="modal-view active" style="padding: 16px;">
                <div style="margin-bottom: 16px;">
                    <label for="aiProvider" style="display: block; margin-bottom: 6px; font-weight: 500;">Default Provider</label>
                    <select id="aiProvider" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                        <option value="openai" selected>OpenAI</option>
                        <option value="claude">Claude (Anthropic)</option>
                    </select>
                </div>
                <div style="margin-bottom: 16px;">
                    <label for="systemPrompt" style="display: block; margin-bottom: 6px; font-weight: 500;">System Prompt (AI Format Tab)</label> <!-- Clarified Label -->
                    <textarea id="systemPrompt" rows="6" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" placeholder="Enter instructions for the initial AI formatting step...">You are a helpful assistant that formats text into clear, structured content. Create organized sections with headings, bullet points, and numbered lists as appropriate.</textarea> <!-- Reduced rows -->
                </div>
                <!-- Added System Prompt for Tab 3 -->
                <div style="margin-bottom: 16px;">
                    <label for="systemPrompt3" style="display: block; margin-bottom: 6px; font-weight: 500;">System Prompt (AI Process Tab)</label>
                    <textarea id="systemPrompt3" rows="6" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" placeholder="Enter specific instructions for the second AI processing step...">You are a helpful assistant that refines existing formatted HTML content based on specific criteria. Analyze the structure and apply the requested changes, returning clean, valid HTML.</textarea> <!-- Default prompt added, reduced rows -->
                </div>
            </div>

            <!-- Model Settings View -->
            <div id="model-settings-view" class="modal-view" style="padding: 16px; display: none;">
                <!-- Provider Tabs (within Model Settings) -->
                <div class="modal-tabs">
                    <button class="modal-tab active" data-tab="openai-panel">OpenAI</button>
                    <button class="modal-tab" data-tab="claude-panel">Claude</button>
                </div>
                <!-- OpenAI Panel -->
                <div id="openai-panel" class="tab-panel active" style="padding-top: 16px;">
                    <!-- System Prompt removed from here -->
                    <div style="margin-bottom: 16px;">
                        <label for="aiModel" style="display: block; margin-bottom: 6px; font-weight: 500;">AI Model</label>
                        <select id="aiModel" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                            <option value="gpt-4">GPT-4 (High quality, more expensive)</option>
                            <option value="gpt-3.5-turbo" selected>GPT-3.5 Turbo (Faster, less expensive)</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label for="temperature" style="display: block; margin-bottom: 6px; font-weight: 500;">Temperature: <span id="tempValue">0.7</span></label>
                        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" style="width: 100%;">
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
                            <span>More focused</span>
                            <span>More creative</span>
                        </div>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label for="apiKey" style="display: block; margin-bottom: 6px; font-weight: 500;">OpenAI API Key</label>
                        <input type="password" id="apiKey" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" placeholder="sk-...">
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">
                            Your API key is stored locally in your browser and never sent to our servers.
                        </div>
                    </div>
                </div>
                <!-- Claude Panel (New) -->
                <div id="claude-panel" class="tab-panel" style="padding-top: 16px; display: none;">
                    <!-- System Prompt removed from here -->
                    <div style="margin-bottom: 16px;">
                        <label for="claudeModel" style="display: block; margin-bottom: 6px; font-weight: 500;">Claude Model</label>
                        <select id="claudeModel" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                            <option value="claude-3-opus-20240229">Claude 3 Opus (High quality)</option>
                            <option value="claude-3-sonnet-20240229" selected>Claude 3 Sonnet (Balanced)</option>
                            <option value="claude-3-haiku-20240307">Claude 3 Haiku (Faster)</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label for="claudeTemperature" style="display: block; margin-bottom: 6px; font-weight: 500;">Temperature: <span id="claudeTempValue">0.7</span></label>
                        <input type="range" id="claudeTemperature" min="0" max="1" step="0.1" value="0.7" style="width: 100%;">
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: #666;">
                            <span>More focused</span>
                            <span>More creative</span>
                        </div>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label for="claudeApiKey" style="display: block; margin-bottom: 6px; font-weight: 500;">Claude API Key</label>
                        <input type="password" id="claudeApiKey" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" placeholder="sk-ant-...">
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">
                            Your API key is stored locally in your browser and never sent to our servers.
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal Actions -->
            <div class="modal-actions">
                <button class="modal-button modal-button-cancel" id="aiModalCancel">Cancel</button>
                <button class="modal-button modal-button-proceed" id="aiModalSave">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="modal"> <!-- Reusing .modal styles -->
        <div class="modal-content" style="width: 600px; max-width: 90%;"> <!-- Wider content area -->
            <div class="modal-header">
                <h3 class="modal-title">AI Format Card Preview</h3>
                <button class="modal-close" id="previewModalClose">&times;</button>
            </div>
            <!-- Controls Bar Below Header -->
            <div class="modal-controls-bar">
                <div class="style-selector" style="margin-left: 0;"> <!-- Removed margin-left auto -->
                    <select id="modalCardStyleSelector" class="style-dropdown">
                        <option value="text-only">Text Only</option>
                        <option value="with-intent" selected>With User Intent</option>
                        <option value="with-pills">With Intent & Pills</option>
                        <option value="with-quick-actions">With Quick Action Menu</option>
                    </select>
                </div>
                <!-- Removed Screenshot Button from Modal Controls -->
            </div>
            <!-- Duplicated Preview Structure -->
            <div class="text-box" style="height: auto; box-shadow: none; padding: 0;"> 
                 <!-- Removed h2 wrapper around controls -->
                 <div class="preview-container" style="min-height: 0;"> 
                    <div id="modalCardPreview" class="preview-content active preview-box"> 
                        <!-- Adjusted max-height to make room for button -->
                        <div class="card-preview-container" style="overflow-y: auto; max-height: 60vh;">
                            <div class="card-preview with-intent" id="modalCardPreviewContent">
                                <div class="card-header">
                                    <span class="return-icon">‚Ü©</span>
                                    <span class="intent-label">User Intent</span>
                                </div>
                                <div class="card-content" id="modalCardContentArea"></div>
                                <div class="card-pill-container">
                                    <span class="card-pill">Option 1</span>
                                    <span class="card-pill">Option 2</span>
                                    <span class="card-pill">Option 3</span>
                                </div>
                                <hr class="card-separator">
                                <div class="quick-action-menu">
                                     <span class="action-item" title="Copy"><svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></span>
                                     <span class="action-item" title="Thumbs Up"><svg viewBox="0 0 24 24"><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"></path></svg></span>
                                     <span class="action-item" title="Thumbs Down"><svg viewBox="0 0 24 24"><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"></path></svg></span>
                                     <span class="action-item" title="Share"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"></path></svg></span>
                                </div>
                            </div>
                        </div>
                        <!-- Added Download Button outside content area but inside modal -->
                        <button id="screenshotButton" class="download-preview-button">Download Preview</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Library Scripts -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@12/dist/markdown-it.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-markup.min.js"></script>
    <!-- Excel and Word parsing libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <!-- Added html2canvas library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Custom JS -->
    <script src="script.js"></script>
</body>
</html>